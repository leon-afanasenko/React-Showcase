(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[516],{35344:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/app/users/[user]",function(){return n(90853)}])},90853:function(e,t,n){"use strict";n.r(t);var r=n(34051),o=n.n(r),s=n(85893),a=(n(83454),n(67294)),i=n(67471),c=n(96857),l=n(44681),u=n(40169),d=n(56365),f=n(91962),h=n(59700),p=n(38945),m=n(1848),x=n(8639),v=n(20640),g=n.n(v),b=n(41664),j=n.n(b),w=n(11163),y=n(44012),N=n(86896),k=n(1852),_=n(49770),Z=n(88305),C=n(68697),O=n(60204),S=n(36090),D=n(60670),E=n(743),A=n(38121),M=n(50073),I=n(2213),L=n(85703),P=n(40031),T=n(73149),B=n(45591),U=n(52937),q=n(4154),F=n(95611),W=n(66320),V=n(27461),z=n(45332),H=n(55670),J=n(27226),Q=n(22379);function R(e,t,n,r,o,s,a){try{var i=e[s](a),c=i.value}catch(l){return void n(l)}i.done?t(c):Promise.resolve(c).then(r,o)}function X(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var s=e.apply(t,n);function a(e){R(s,r,o,a,i,"next",e)}function i(e){R(s,r,o,a,i,"throw",e)}a(void 0)}))}}function G(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function K(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){G(e,t,n[t])}))}return e}var Y=function(e){var t,n,r,v,b,C=e.id,R=e.username,G=e.userData,Y=(e.otherUsers,(0,Z.u)(B.w).useListOfJobs),$=(0,Z.u)(q.V),ee=$.setModalState,te=($.setQuery,$.query,$.setQueryVal,$.setTempQuery,$.fullWidth),ne=(0,T.aC)(),re=ne.userInfo,oe=ne.modCheck,se=(0,F.Z)(G),ae=se.handleFollow,ie=se.followed,ce=(0,w.useRouter)(),le=(0,k.useMediaQuery)({maxWidth:768}),ue=(0,a.useState)(!0),de=ue[0],fe=ue[1],he=Y({defaultSort:"hot",searchType:"advanced",initialSettings:K({jobStatus:"completed",userId:C},C===(null===re||void 0===re?void 0:re.id)?{isPublished:"true"}:{},{orderBy:(null===(t=ce.query)||void 0===t?void 0:t.sort)||"hot",minRankingScore:"0",prompt:null===(n=ce.query)||void 0===n?void 0:n.search})},{label:H.xe.TODO});(0,a.useEffect)((function(){setTimeout((function(){return he.firstLoad()}),1)}),[]),(0,a.useEffect)((function(){he.jobsList.length>0&&ee((function(e){return K({},e,{jobDataArray:he.jobsList,jobDataArrayCache:he.jobsList})}))}),[he.jobsList,ee]);var pe=(0,a.useState)(!1),me=pe[0],xe=pe[1],ve=(0,a.useMemo)((function(){return[le&&{title:"View archive",link:"/app/users/".concat(C,"/archive"),icon:(0,s.jsx)(i.Z,{height:18})},le&&{title:ie?"Unfollow":"Follow",warn:ie,onClick:ae,icon:ie?(0,s.jsx)(c.Z,{height:"16",className:""}):(0,s.jsx)(l.Z,{height:"16",className:""}),slug:"follow"},le&&oe("moderator")&&{title:"break-9"},oe("moderator")&&{title:"Mod Actions",disabled:!0,icon:(0,s.jsx)(u.Z,{height:"16",className:""}),optionArray:[{title:"Open in Mod Panel",link:"/mods/users/".concat(C,"/archive"),icon:(0,s.jsx)(d.Z,{height:"16"}),slug:"open-mod-panel"},{title:"Copy Discord ID",onClick:function(){return(0,A.Dq)(C)},icon:(0,s.jsx)(E.O5,{height:"16"}),slug:"copy-userid"},{title:"Copy ID",onClick:function(){return g()(C)},icon:(0,s.jsx)(f.Z,{height:"16"}),slug:"copy-userid"},{title:"Contact",onClick:function(){var e=prompt("What is your message for ".concat(R,"?")),t=confirm("Do you want to clear their queue and force a response? OK for yes, Cancel for no.");e&&fetch("/api/app/users/mod-contact",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:C,message:e.trim(),resetCooldowns:t})}).then(function(){var e=X(o().mark((function e(t){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.json();case 2:!(null===(n=e.sent)||void 0===n?void 0:n.error)&&t.ok?(0,J.z5)("Message sent!"):(0,J.x8)("Message failed to send: ".concat(t.status," ").concat((null===n||void 0===n?void 0:n.error)||t.statusText," (").concat(n.trace,")"));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){(0,J.x8)("Error sending message: ".concat(e))}))},icon:(0,s.jsx)(h.Z,{height:"16",className:""})},oe("community")&&{title:"Wipe User",danger:!0,onClick:function(){confirm("Are you sure you want to wipe all jobs for ".concat(R,"?"))&&confirm("Absolutely, 100% super-duper sure you want to wipe all jobs for ".concat(R,"?"))&&fetch("/api/mod/wipe-user",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:C})}).then((function(e){200===e.status?(0,J.z5)("User wiped! Reload the page to see changes."):(0,J.x8)("Something went wrong: : ".concat(e.status," ").concat(e.statusText))})).catch((function(e){(0,J.x8)("Something went wrong: ".concat(e))}))},icon:(0,s.jsx)(p.Z,{height:"16",className:""})}].filter(Boolean)}].filter(Boolean)}),[ie,ae,C,le,oe,R]),ge=(0,a.useMemo)((function(){return(0,s.jsxs)(s.Fragment,{children:[!le&&(0,s.jsxs)(D.Z,{href:"/app/users/".concat(C,"/archive"),className:".border-2 group flex min-w-max max-w-max items-center justify-center gap-2 rounded-full bg-slate-300 !bg-opacity-100 !px-6 !font-bold text-darkBlue-500 hover:!bg-slate-200",children:[(0,s.jsx)(i.Z,{height:18})," ",(0,s.jsx)("span",{className:"hidden md:inline",children:(0,s.jsx)(y.Z,{id:"nav.archive"})})]},"archive"),!le&&(0,s.jsx)(S.Z,{onClick:function(){xe(!0),ae()},onMouseLeave:function(){return xe(!1)},className:"group-button .border-2 flex min-w-max max-w-max items-center justify-center gap-2 rounded-full  bg-slate-300 !bg-opacity-100 !px-6 !font-bold text-darkBlue-500 ".concat(ie&&!me?" hover:border-red-700 hover:!bg-red-900 hover:text-red-200 ":"hover:!bg-slate-200"),children:ie?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:me?"flex":"flex [.group-button:hover_&]:hidden",children:"Following"}),(0,s.jsx)("span",{className:me?"hidden":"relative hidden before:text-transparent before:content-['Following'] [.group-button:hover_&]:flex",children:(0,s.jsx)("span",{className:"centerAbs absolute",children:"Unfollow"})})]}):(0,s.jsx)("span",{className:"relative flex before:text-transparent before:content-['Following']",children:(0,s.jsxs)("span",{className:"centerAbs absolute flex items-center justify-center",children:[(0,s.jsx)(l.Z,{height:18,className:"mr-2 inline"}),(0,s.jsx)(y.Z,{id:"app.follow"})]})})},"followButton"),le||oe("moderator")&&(0,s.jsx)(I.Z,{optionArray:ve,maxWidth:"!w-max",placement:"top-end",className:"h-full",offset:[0,10],transformOrigin:"top-right",buttonHoverStyle:"!rounded-full",children:(0,s.jsx)(S.Z,{className:(0,z.CN)("group aspect-square md:text-darkBlue-500 rounded-full .border-2 bg-slate-100/5  md:bg-slate-300 md:hover:!bg-slate-200 flex gap-2 items-center justify-center !bg-opacity-100"),children:(0,s.jsx)(m.Z,{height:le?18:24})},"options")})]})}),[ve,me,ie,ae,C,le,oe]),be=(0,a.useMemo)((function(){return(null===G||void 0===G?void 0:G.created)?"".concat(new Date(G.created).toLocaleString("en-us",{month:"short"})," ").concat(new Date(G.created).getFullYear()):"Unknown"}),[null===G||void 0===G?void 0:G.created]),je=(0,N.Z)(),we=(0,_.Z)("/api/app/users/info/?userId=".concat(C),z.EE,{fallbackData:{usage_lifetime_count:"..."},revalidateOnMount:!0}).data.usage_lifetime_count;return(0,s.jsxs)(U.x.Provider,{initialState:{feed:he},children:[(0,s.jsxs)(V.o,{title:R||"User",fullWidth:te,className:z.VU,icon:(0,s.jsx)(Q.Avatar,{user:C,avatar:null===G||void 0===G?void 0:G.avatar_job_id,size:32}),meta:(0,s.jsx)(W.h,{title:je.formatMessage({id:"app.usersGallery"},{user:R}),description:je.formatMessage({id:"app.allTheImages"},{id:C})}),children:[(0,s.jsx)(Q.UserBanner,{bannerUrl:"https://mj-gallery.com/".concat((null===G||void 0===G?void 0:G.cover_job_id)||(null===(r=he.jobsList)||void 0===r||null===(v=r[0])||void 0===v?void 0:v.state.id),"/grid_0.webp"),username:R,children:(0,s.jsx)(Q.UserBannerInfo,{avatar:G.avatar_job_id,tagline:(0,s.jsxs)("p",{children:[(null===we||void 0===we?void 0:we.toLocaleString())||"N/A"," Jobs"," ",(0,s.jsxs)("span",{className:"text-slate-500",children:[(0,s.jsx)(y.Z,{id:"app.since"})," ",be]})]}),user:G,username:R,customButtons:ge})}),de&&(0,s.jsxs)("div",{className:"relative mt-4 mb-6 flex w-full flex-col gap-4 md:mt-2 md:px-4 xl:my-6",children:[(0,s.jsxs)("div",{className:"-mb-3 flex w-full justify-between px-2 text-base",children:[(0,s.jsx)("p",{className:"font-medium text-slate-400"}),(0,s.jsx)(j(),{href:"/app/users/".concat(C,"/collections"),children:(0,s.jsxs)("a",{href:"",className:"text-slate-500 hover:text-slate-300",children:[(0,s.jsx)(y.Z,{id:"app.viewAllCollections"})," ",(0,s.jsx)(x.Z,{height:18,className:"inline -rotate-45"})]})})]}),(0,s.jsx)(O.Z,{userId:C,home:!0,hideCallback:function(){return fe(!1)},className:"miniScrollbar w-full gap-4 overflow-x-scroll py-2",buttonClassName:"md:basis-1 max-w-[50%] md:max-w-[33%]",showAddButton:!1,maxItems:4,publicDisplay:!0})]}),(0,s.jsx)(L.x,{fixedData:he,params:{showService:!0}}),(0,s.jsx)(P.H,{query:null===(b=ce.query)||void 0===b?void 0:b.jobId,returnHref:"/app/users/".concat(C)}),(0,s.jsx)(M.Z,{fixedData:he,settings:{dedupe:!1}})]})," "]})};Y.getInitialProps=function(){var e=X(o().mark((function e(t){var n,r,s,a,i,c,l,u,d,f;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.query.user,(0,C.Z)(a)){e.next=11;break}return e.next=5,(0,z.EE)("".concat("https://www.midjourney.com","/api/auth/get-user/?discord_id=").concat(a));case 5:if(null===(i=e.sent)||void 0===i?void 0:i.user_id){e.next=9;break}return(0,z.FA)(t,"/404"),e.abrupt("return",{});case 9:return(0,z.FA)(t,"/app/users/".concat(i.user_id)),e.abrupt("return",{});case 11:return e.next=13,fetch("".concat("https://www.midjourney.com","/api/app/users/?userIds=").concat(t.query.user),{headers:{Cookie:null===(n=t.req)||void 0===n?void 0:n.headers.cookie}});case 13:return c=e.sent,e.next=16,c.json();case 16:return l=e.sent,u=[null===(r=l[0])||void 0===r?void 0:r.user_id,null===(s=l[0])||void 0===s?void 0:s.username],f=u[1],(d=u[0])&&f||(0,z.FA)(t,"/404"),e.abrupt("return",{id:d,username:f,userData:l[0],otherUsers:l});case 20:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.default=Y},59700:function(e,t,n){"use strict";var r=n(67294);const o=r.forwardRef((function(e,t){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:t},e),r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"}))}));t.Z=o}},function(e){e.O(0,[9774,2888,179],(function(){return t=35344,e(e.s=t);var t}));var t=e.O();_N_E=t}]);